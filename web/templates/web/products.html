{% extends 'web/base.html' %}

{% block page_body %}
<div class="row">
    {% for p in product_list %}
        <div class="col-xs-12 col-sm-4 col-md-3 col-lg-3">
            <div class="product text-center">
                <div class="text-primary">{{p.name}}</div>
                <div class="product-price">$ {{p.unit_price}}</div>
                <a class="btn btn-info" href="javascript:addToCart({{p.id}})" role="button">Add</a>
            </div>
        </div>
    {% endfor %}
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">&nbsp;</div>
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <a class="btn btn-info" href="{% url 'ol:order-review' %}" role="button">Review Order</a>
    </div>
</div>
{% endblock %}

{% block javascript %}
{{ block.super }}

var addToCart = function(productId){
    $.ajax({
        url: "/web/api/add-to-cart/" + productId,
        method: "GET"
    }).done(function(response){
        response.payloads.forEach(function(data){
            $.notify(data.message, "success");
        });
    }).error(function(response){
        response.payloads.forEach(function(data){
            $.notify(data.message, "error");
        });
    });
};
{% endblock %}